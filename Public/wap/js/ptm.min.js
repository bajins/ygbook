(function(d) {
    var c = {};
    var a = function(e) {
            var f = this;
            f.config = $.extend({ title: "", content: "内容", shadeClose: true, anim: true }, e);
            f.show()
        },
        b = 0;
    d.PTDialogData = { timer: {}, end: {} };
    a.prototype.show = function() {
        var j = this,
            e = j.config;
        j.id = "ptm-alert" + b;
        var k = (function() { var l = typeof e.title === "object"; return e.title ? '<p class="ptm-alert-title" style="' + (l ? e.title[1] : "") + '">' + (l ? e.title[0] : e.title) + "</p>" : "" }());
        var g = (function() { var l = ""; if (e.okval) { if (e.cancelval) { l = '<a class="ptm-alert-btn-ok">' + e.okval + "</a>" } else { l = '<a class="ptm-alert-btn-ok" style="margin:0 20%">' + e.okval + "</a>" } } if (e.cancelval) { l = '<a class="ptm-alert-btn-cancel">' + e.cancelval + "</a>" + l } if (l) { l = '<div class="ptm-alert-btn">' + l + "</div>" } else { e.time = e.time ? e.time : 2 } return l }());
        var i = (function() { return '<p class="ptm-alert-content">' + e.content + "</p>" }());
        var f = '<div class="ptm-alert-shade ' + j.id + '"></div><div class="ptm-alert-box ' + j.id + '" data-index="' + b + '">' + k + i + g + "</div>";
        $("body").append(f);
        var h = j.elem = $("#" + j.id)[0];
        setTimeout(function() { e.success && e.success($("." + j.id)) }, e.time * 1000);
        j.index = b++;
        j.action(e, h)
    };
    a.prototype.action = function(e, g) {
        var f = this;
        if (e.time) { PTDialogData.timer[f.index] = setTimeout(function() { $ptm.alert.close(f.index) }, e.time * 1000) }
        $(".ptm-alert-btn-ok", g).on("click", function() {
            e.okfunc && e.okfunc();
            $ptm.alert.close(f.index)
        });
        $(".ptm-alert-btn-cancel", g).on("click", function() {
            e.cancelfunc && e.cancelfunc();
            $ptm.alert.close(f.index)
        });
        $(".ptm-alert-shade", g).on("click", function() { $ptm.alert.close(f.index) });
        e.end && (PTDialogData.end[f.index] = e.end)
    };
    c.range = function(j, o) {
        var f = null;
        var e, g, k, n, i;
        var m = function() {
            n = j.attr("max");
            i = j.attr("min");
            e = Math.abs(n - i);
            g = j[0].offsetLeft;
            k = j.width() - 28;
            j.after('<div class="ptm-range-tip ptm-hide">' + j.val() + "</div>");
            var p = (k / e) * Math.abs(j.val() - i);
            j.next().css("left", (g + p - 11) + "px");
            j.on("change", function() { l() });
            j.on("touchmove", function() { l() });
            j.on("touchend", function() { h() })
        };
        var l = function() {
            j.next().removeClass("ptm-hide");
            var p = (k / e) * Math.abs(j.val() - i);
            j.next().css("left", (g + p - 11) + "px");
            j.next().text(j.val());
            o(j.val())
        };
        var h = function() {
            if (f) { clearTimeout(f) }
            f = setTimeout(function() { j.next().addClass("ptm-hide") }, 1500)
        };
        m()
    };
    c.alert = {
        open: function(e) { e = e ? e : {}; return new a(e) },
        close: function(e) {
            var f = $(".ptm-alert" + e);
            if (!f) { return }
            f.remove();
            clearTimeout(PTDialogData.timer[e]);
            delete PTDialogData.timer[e];
            typeof PTDialogData.end[e] === "function" && PTDialogData.end[e]();
            delete PTDialogData.end[e]
        },
        closeAll: function() { var f = $(".ptm-alert-box"); for (var g = 0, e = f.length; g < e; g++) { layer.close((f[0].data("index") | 0)) } }
    };
    c.toast = function(e) {
        var g = e ? e : "加载中...";
        var f = '<div class="ptm-toast"><div class="ptm-toast-area"><p class="ptm-toast-content">' + g + "</p></div></div>";
        $(".ptm-toast").remove();
        $("body").append(f);
        $(".ptm-toast").fadeIn(300);
        setTimeout(function() { $(".ptm-toast").fadeOut(300) }, 1500)
    };
    c.loading = {
        open: function(e) {
            var g = e ? e : "加载中...";
            var f = '<div class="ptm-loading-toast"><div class="ptm-loading-area"><p class="ptm-loading-content"><i class="ptm-loading-anim"></i>' + g + "</p></div></div>";
            $(".ptm-loading-toast").remove();
            $("body").append(f);
            $(".ptm-loading-toast").show(300)
        },
        close: function() {
            $(".ptm-loading-toast").hide(300);
            $(".ptm-loading-toast").remove()
        }
    };
    c.tab = function(f, e) {
        $(f).on("click", function() {
            $(this).addClass("active").siblings().removeClass("active");
            $(e).eq($(this).index()).addClass("active").siblings().removeClass("active")
        })
    };
    c.actionsheet = {
        open: function() {
            var e = $(".ptm-actionsheet-mask");
            var f = $(".ptm-actionsheet");
            f.addClass("ptm-actionsheet-toggle");
            e.show().addClass("ptm-actionsheet-mask-toggle").click(function() { $ptm.actionsheet.close() });
            $("#actionsheet_cancel").click(function() { $ptm.actionsheet.close() });
            f.unbind("transitionend").unbind("webkitTransitionEnd")
        },
        close: function() {
            var e = $(".ptm-actionsheet-mask");
            var f = $(".ptm-actionsheet");
            f.removeClass("ptm-actionsheet-toggle");
            $(".ptm-actionsheet-mask").removeClass("ptm-actionsheet-mask-toggle");
            f.on("transitionend", function() { $(".ptm-actionsheet-mask").hide() }).on("webkitTransitionEnd", function() { $(".ptm-actionsheet-mask").hide() })
        }
    };
    d.$ptm = c
})(window, $);